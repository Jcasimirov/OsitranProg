<?xml version='1.0' encoding='windows-1252'?>
<!DOCTYPE html>
<f:view xmlns:f="http://java.sun.com/jsf/core" xmlns:h="http://java.sun.com/jsf/html"
        xmlns:ui="http://java.sun.com/jsf/facelets">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:p="http://primefaces.org/ui">
        <h:head>
           <link href="#{request.contextPath}/css/style.css" rel="stylesheet" type="text/css"/>
            </h:head>
    <h:body>    
    <f:event listener="#{registrarAvanceInversionPMB.cargarMoneda()}" type="postAddToView"></f:event>
         <f:event listener="#{registrarAvanceInversionPMB.validarSesion}" type="preRenderComponent"></f:event>

	<h:form id="form">
            <p:growl id="mensaje" showDetail="true" life="10000"/>
            <p:layout fullPage="true" style="border:none">
            <p:layoutUnit position="center" style="border:0px">
            <ui:include src="/ositran/util/menuOpciones.xhtml"/>
            <div align="center" >
            
                    <div align="center" ><h5 class="titulo5">REGISTRAR AVANCE INVERSIÓN</h5></div>
		<table style="font-size: 11px">
			<tr>
				<td valign="top">
				<p:fieldset legend="Datos Contrato Concesión">
				
					
				<p:fieldset styleClass="fielsetinterno" legend="Criterio de Busqueda">
                               
                                        <h:outputText value="Buscar Contratos Concesión"></h:outputText>
                                        <h:outputText style="color:White" value="n"></h:outputText>
					<p:commandButton image="ui-icon-search"
                                                                oncomplete="panelListaContratos.show()"
                                                                id="cargarContrato" 
                                                                update=":form:panelListaContratos"
                                                                actionListener="#{registrarAvanceInversionPMB.cargarListaContratos}"
                                                                
                                                                />
                                        <p:tooltip styleClass="tool" id="tool2" for="cargarContrato"
                                                          value="Cargar lista de contrato concesión"/>
                                                               
				</p:fieldset>
					<br></br>
				<p:fieldset styleClass="fielsetinterno" id="datosConcesion" legend="Datos Concesión">
					<table>
									<tr>
										<td align="left">Concesión</td>
										<td><p:inputText value="#{registrarAvanceInversionPMB.nombreConcecion}" readonly="true" ></p:inputText></td>
									</tr>
									<tr>
										<td align="left">Tipo Infraestructura</td>
										<td><p:inputText value="#{registrarAvanceInversionPMB.nombreTipoInfraestructura}"  readonly="true"></p:inputText></td>
									</tr>
									<tr>
										<td align="left">Modalidad Concesión</td>
										<td><p:inputText value="#{registrarAvanceInversionPMB.nombreModalidadConceción}" readonly="true"></p:inputText></td>
									</tr>
                                   	
                                                                      	
								</table>
				</p:fieldset>
                               <br></br>
				<p:fieldset styleClass="fielsetinterno" id="datosCompromiso" legend="#{leg.etaCo}">
                                                <table>
									<tr>
										<td colspan="1" align="left">#{cam.setapa}</td>
										<td colspan="3" align="left">
                                                                                    <p:selectOneMenu id="listaCompromiso"  value="#{registrarAvanceInversionPMB.contratoCompromisoSeleccionado}">
										        <f:selectItem   itemLabel="-Selecione-" itemValue="0" />
										        <f:selectItems  
                                                                                                value="#{registrarAvanceInversionPMB.listaContratoCompromiso}"  
                                                                                                var="tip2"
                                                                                                itemLabel="#{tip2.ccoPeriodo}" 
                                                                                                itemValue="#{tip2.ccoId}"/>
                                                                                        <p:ajax event="valueChange" 
                                                                                                update=":form:datosCompromiso " 
                                                                                                listener="#{registrarAvanceInversionPMB.cargarDatosCompromiso()}"  /> 
                                                                                    </p:selectOneMenu>
										</td>
									</tr>
									
									<tr>
										<td align="left">Plazo:</td>
										<td align="left" colspan="3"><p:inputText value="#{registrarAvanceInversionPMB.plazo}" size="10"  /></td>
										
									</tr>
									<tr>
										<td align="left">Total:</td>
										<td align="left" ><p:inputText value="#{registrarAvanceInversionPMB.plazo}" size="10"></p:inputText></td>
										<td align="left">#{cam.mon}</td>
										<td align="left"><p:inputText value="#{registrarAvanceInversionPMB.plazo}"  size="10"></p:inputText></td>
									</tr>
								</table>
							</p:fieldset>
					</p:fieldset>	
				</td>
				<td valign="top">
				<p:fieldset legend="Solicitud del Concesionario">
					<p:fieldset styleClass="fielsetinterno" id="datosSDT" legend="Datos STD">
                                        
                                        <table>
                                            <tr>
                                                <td class="negrita">Nro HR: <h:outputText style="color:White" value="n"/></td>
                                                 <td >
                                                   
                                                    Nro: <p:inputText value="#{registrarAvanceInversionPMB.numero}"  style="width:60px"  />
                                                     <h:outputText style="color:White" value="nnn"/>
                                                    </td>
                                                  <td >Año: <p:inputText value="#{registrarAvanceInversionPMB.anio}" style="width:60px" />
                                                    <p:commandButton image="ui-icon-search" 
                                                                     actionListener="#{registrarAvanceInversionPMB.cargarDatosSDT()}"  
                                                                     update=":form:datosSDT :form:mensaje"/>  </td>
                                                       
                                                   <td> <h:outputText style="color:White" value="nn"/>
                                                   Fecha Registro: <p:calendar value="#{registrarAvanceInversionPMB.fechaRegistroSDT}" locale="es" styleClass="calendario1"  /></td>
                                            </tr>
                                             <tr>
                                                <td class="negrita">Asunto:</td>
                                                
                                                 <td colspan="3"><p:inputTextarea  value="#{registrarAvanceInversionPMB.asunto}"  style="width:97%;height:25px" /></td>
                                                  
                                            </tr>
                                             <tr>
                                                <td class="negrita">Plazo:</td>
                                                <td><p:inputText value="#{registrarAvanceInversionPMB.plazo}"  style="width:70px" /></td>
                                                 <td>
                                                    <table style="font-size:9px;width:100%">
                                                            <tr>
                                                                <td><p:selectBooleanCheckbox  value="#{registrarAvanceInversionPMB.diasCalendario}" id="diasCalendario">
                                                                     <p:ajax update=":form:diasHabiles" listener="#{registrarAvanceInversionPMB.desDiasHabiles}"/>
                                                                </p:selectBooleanCheckbox  > Calendarios</td>
                                                            </tr>
                                                             <tr>
                                                                <td><p:selectBooleanCheckbox value="#{registrarAvanceInversionPMB.diasHabiles}" id="diasHabiles" >
                                                                 <p:ajax update=":form:diasCalendario" listener="#{registrarAvanceInversionPMB.desDiasCalendario}"/>
                                                                </p:selectBooleanCheckbox> Habiles</td>
                                                            </tr>
                                                    </table>
                                                 </td>
                                                <td >Vencimiento Plazo: <p:calendar locale="es" styleClass="calendario1"   /></td>
                                            </tr>
                                        </table>												
					</p:fieldset>				 	
					<br></br>
					<p:fieldset styleClass="fielsetinterno" legend="Datos Valorización">
					
                                        <table>
                                            <tr>
                                                <td>Periodo Ejecución(Inicio)</td> 
                                                <td><p:calendar locale="es"  value="#{registrarAvanceInversionPMB.inicioPeriodo}" styleClass="calendario1" /></td> 
                                                <td>Periodo Ejecución(Fin)</td> 
                                                <td><p:calendar locale="es" value="#{registrarAvanceInversionPMB.finPeriodo}"  styleClass="calendario1"  /></td> 
                                                <td colspan="2">
                                                <table>
                                                    <tr>
                                                        <td>Moneda </td>
                                                        <td>
                                                        <p:selectOneMenu id="ListaMoneda" value="#{registrarAvanceInversionPMB.codMoneda}">
                                                                <f:selectItem  itemLabel="-Seleccione-" itemValue="0" />
                                                                <f:selectItems var="varMoneda" value="#{registrarAvanceInversionPMB.listaMoneda}" itemLabel="#{varMoneda.monNombre}" itemValue="#{varMoneda.monId}" />
                                                            </p:selectOneMenu>
                                                        
                                                        </td>
                                                    </tr>
                                                
                                                </table>
                                                </td>
                                            </tr>
                                            </table>
                                            <br>
                                            </br>
                                            <table style="width:100%">
                                           
                                            <tr>
                                                 <td>Concepto:</td> 
                                                <td>
                                                          <p:selectOneMenu style="width:110px" id="inversionDescripcion"  value="#{registrarAvanceInversionPMB.codigoInversionDescripcion}">
                                                                <f:selectItem  itemLabel="-Seleccione-" itemValue="0" />
                                                                <f:selectItems value="#{registrarAvanceInversionPMB.listaDescripcionTipoInversion}"  var="varInversion"
                                                                                itemLabel="#{varInversion.itdNombre}" 
                                                                                itemValue="#{varInversion.itdId}"
                                                                                 />
                                                              
                                                            </p:selectOneMenu>
                                                </td> 
                                                <td>Monto Presentado</td> 
                                                <td>  <p:inputText value="#{registrarAvanceInversionPMB.montoPrestado}" style="width:60px" /></td> 
                                                <td> <p:selectBooleanCheckbox value="#{registrarAvanceInversionPMB.igv}" />
                                                        <h:outputText style="font-size:9px"   value="Con IGV" />
                                                </td> 
                                                <td align="right">
                                                <p:commandButton value="Agregar"  update=":form:tablaVS :form:mensaje :form:montosTotales1 :form:montosTotales2 :form:montosTotales3" actionListener="#{registrarAvanceInversionPMB.agregar}"  image="ui-icon-circle-plus" />
                                                </td>  
                                            </tr>
                                              <tr>
                                                <td>Descripción</td>
                                                <td colspan="5">
                                                <p:inputText style="width:345px" value="#{registrarAvanceInversionPMB.descripcionValorizacionDetalle}" />
                                                </td>
                                            
                                            
                                            </tr>
                                        </table>
                              
                                                        
                                   
							
							</p:fieldset>
							<br></br>
				</p:fieldset>	
                                <br></br>
                               
                            
                                
                                
				</td>
			</tr>
                        
                        <tr>
                        <td colspan="2">
                           <p:dataTable rowIndexVar="rowId"   paginatorPosition="bottom" rows="10" emptyMessage="NO SE ENCONTRARON DATOS"
                                             style="font-size:9px;" id="tablaVS" var="valSup1"
                                             value="#{registrarAvanceInversionPMB.listValorizacionInversionAvanceDetalleVO}">
						       			
                                                                         <p:column headerText="Concepto"  >
						          			 <h:outputText   value="#{valSup1.descripcionInversion}"></h:outputText>
						       			</p:column>
						       			 <p:column headerText="Descripción del Concepto" >
						          			 <h:outputText  value="#{valSup1.iadDescripcion}"></h:outputText>
						       			</p:column>	
						       			 <p:column headerText="Moneda" >
						          			 <h:outputText value="#{valSup1.nombreMoneda}"></h:outputText>
						       			</p:column>	
						       			<p:column headerText="Neto" >
						          			 <h:outputText  value="#{valSup1.montoPresentado}"></h:outputText>
						       			</p:column>	
						       			<p:column headerText="Igv" style="width:15px">
						          			 <h:outputText  value="#{valSup1.igv}"></h:outputText>
						       			</p:column>
                                                                        <p:column headerText="Inicio" >
						          			 <p:calendar  pattern="dd/MM/yyyy" styleClass="calendario1" readonly="true" value="#{valSup1.iadFechaInicio}"></p:calendar>
						       			</p:column>
                                                                        <p:column headerText="Fin" >
						          			 <p:calendar pattern="dd/MM/yyyy"  styleClass="calendario1" readonly="true"   value="#{valSup1.iadFechaFin}"></p:calendar>
						       			</p:column>
                                                                        <p:column headerText="Total">
						          			 <h:outputText  value="#{valSup1.tiaTotal}"></h:outputText>
						       			</p:column>
                                                                        <p:column headerText="Eliminar" >
                                                                        <div align="center">
						          			 <p:commandButton styleClass="controles"  update=":form:tablaVS :form:montosTotales1 :form:montosTotales2 :form:montosTotales3" actionListener="#{registrarAvanceInversionMB.quitarLista}" image="ui-icon-trash" >
                                                                                                    <f:param id="indexLista" name="indexLista" value="#{rowId}"/>
                                                                                 </p:commandButton>
                                                                        </div>
						       			</p:column>
							</p:dataTable>
                                                        <br></br>
                                                         <br></br>
                                                        <div align="right" class="negrita">Total Neto: 
                                                            <p:inputText id="montosTotales1"  value="#{registrarAvanceInversionPMB.totalMonto}"  style="width:75px" />
                                                            Total Igv: 
                                                             <p:inputText id="montosTotales2"  value="#{registrarAvanceInversionPMB.totalIgv}"    style="width:75px"/>
                                                             Total : 
                                                              <p:inputText  id="montosTotales3"  value="#{registrarAvanceInversionPMB.totalTotal}"  style="width:75px"/>
                                                        </div>
                           <br></br>
                        </td>
                       
                                                        
                        </tr>
                        
                        
		</table>	
		</div>               
                  <div style="text-align:center;font-size: 11px">
                                 <p:commandButton  style="width:80px"  update=":form:mensaje" actionListener="#{registrarAvanceInversionPMB.guardar()}"  value="Guardar"/>
                                    <p:commandButton style="width:80px" value="Limpiar"/>
                                    </div>
                </p:layoutUnit>
            </p:layout>
            
             <p:dialog width="40%"  header="Lista Contratos" widgetVar="panelListaContratos" id="panelListaContratos" 
                          style="text-align:center;">
                    
                            <p:dataTable paginatorPosition="bottom" rows="10" emptyMessage="NO SE ENCONTRARON DATOS"
                                             paginator="true"
                                             rowsPerPageTemplate="6,8,10" 
                                             style="font-size:11px" id="tablaLC" var="lisContratos1"
                                             value="#{registrarAvanceInversionPMB.listaContratos}">
                                 <p:column headerText="ID" style="width:5px">
                                        <h:outputText value="#{lisContratos1.conId}" />
                                    </p:column>
                                    <p:column headerText="Nombre" style="width:50px">
                                        <h:outputText value="#{lisContratos1.nombreConcesion}" />
                                    </p:column>
                                  
                                    <p:column   headerText="Elegir" style="width:5px" >
                                        <div align="center">
                                            <p:commandButton
                                                oncomplete="panelListaContratos.hide()" 
                                                actionListener="#{registrarAvanceInversionPMB.elegirContrato(lisContratos1)}"
                                                image="ui-icon-circle-check"  
                                                id="selecionarContratos"
                                                style="width:22px;height:22px"
                                                update=":form:datosConcesion :form:inversionDescripcion  :form:datosCompromiso "
                                                >
                                                
                              
                                            </p:commandButton>
                                              <p:tooltip styleClass="tool" id="tool3" for="selecionarContratos"
                                                          value="Selecionar un contrato"/>
                                        </div>
                                    </p:column>
                                </p:dataTable>                   
                </p:dialog>
            
	</h:form>
      
    </h:body>
    </html>
</f:view>