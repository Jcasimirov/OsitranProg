<?xml version='1.0' encoding='windows-1252'?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:p="http://primefaces.org/ui">

        <h:head>
            <style type="text/css">
                .ui-dialog-titlebar {
                    font-size: 13px;
                    font-family: sans-serif;
                }
            </style>
            <link href="#{request.contextPath}/css/diseño.css" rel="stylesheet" type="text/css"/>
            <script type="text/javascript">
              PrimeFaces.locales['es'] = {
                  closeText : 'Cerrar', prevText : 'Anterior', nextText : 'Siguiente', monthNames : ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'], monthNamesShort : ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'], dayNames : ['Domingo', 'Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado'], dayNamesShort : ['Dom', 'Lun', 'Mar', 'Mie', 'Jue', 'Vie', 'Sab'], dayNamesMin : ['D', 'L', 'M', 'X', 'J', 'V', 'S'], weekHeader : 'Semana', firstDay : 1, isRTL : false, showMonthAfterYear : false, yearSuffix : '', timeOnlyTitle : 'Sólo hora', timeText : 'Tiempo', hourText : 'Hora', minuteText : 'Minuto', secondText : 'Segundo', currentText : 'Fecha actual', ampm : false, month : 'Mes', week : 'Semana', day : 'Día', allDayText : 'Todo el día'
              };
            </script>
        </h:head>
     <ui:include src="/ositran/util/menuOpciones.xhtml"/>
        <h:body>
        <f:event listener="#{bk_NotificarInversion.validarSesion}" type="preRenderComponent"></f:event>
            <f:event listener="#{bk_NotificarInversion.listarTipoAprobaciones}" type="preRenderComponent"/>             
            <f:event listener="#{bk_NotificarInversion.listarDeclaraciones}" type="preRenderComponent"/>
            <f:event listener="#{bk_NotificarInversion.listarTiposMoneda}" type="preRenderComponent"/>
            <f:event listener="#{bk_NotificarInversion.cargarConceptos}" type="preRenderComponent"/>
          
            <p:growl id="mensaje" showDetail="true" life="3000"/>
            <p:layout style="min-width:400px;min-height:500px;">
                <p:layoutUnit position="center" minSize="300" visible="true" style="text-aling:center;">
                  <h:form  id="form" binding="#{bk_NotificarInversion.form}">
                    
                    <div align="center">
                        <h3 style="color:Black;font-weight:bold;font-family: sans-serif;">
                            NOTIFICAR INVERSIONES DECLARADAS
                        </h3>
                    </div>
                    <div align="center" >
                <div style="width:90%" >
                <p:dataTable paginatorPosition="bottom"
                                emptyMessage="NO SE ENCONTRARON DATOS" rows="10" paginator="true"
                                             paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                             rowsPerPageTemplate="5,10,20" 
                                              id="tablaValorizaciones" var="val" style="font-size:10px"
                                             value="#{bk_NotificarInversion.listaValorizaciones}"
                                             rowIndexVar="rowIndex"> 
                
                        <p:column headerText="N°" style="font-size: 9px">
                            <h:outputText value=" #{rowIndex+1}" style="text-transform:uppercase; font-size: 9px"/>
                        </p:column>
                        <p:column headerText="Infraestructura" style="font-size: 9px">
                            <div style="text-align: center;">
                                <h:outputText value="#{val.nombreTipoInfraestructura}"
                                              style="text-transform:uppercase; font-size: 9px"/>
                            </div>
                        </p:column>
                        <p:column headerText="Nro.Valorización"  style="font-size: 9px">
                            <h:outputText value="#{val.tiaNumero}" style="text-transform:uppercase; font-size: 9px;"/>
                        </p:column>
                        <p:column headerText="Fecha Reg." style="font-size: 9px">
                            <h:outputText value="#{val.tiaFechaRegistroDescripcion}" style="text-transform:uppercase; font-size: 9px;"/>
                        </p:column>
                        <p:column headerText="Moneda" style="font-size: 9px">
                            <h:outputText value="#{val.nombreMoneda}" style="text-transform:uppercase; font-size: 9px;"/>
                        </p:column>
                        <p:column headerText="Total Presentado" style="font-size: 9px">
                            <h:outputText value="#{val.tiaMontoTotalPresentado}" style="text-transform:uppercase; font-size: 9px;"/>
                        </p:column>
                        <p:column headerText="Total Reconocido" style="font-size: 9px">
                            <h:outputText value="#{val.tiaMontoTotalAprobado}" style="text-transform:uppercase; font-size: 9px;"/>
                        </p:column>
                        <p:column headerText="Total Reajustado" style="font-size: 9px">
                            <h:outputText value="#{val.tiaMontoTotalReajustado}" style="text-transform:uppercase; font-size: 9px;"/>
                        </p:column>
                        <p:column headerText="Estado" style="font-size: 9px">
                            <h:outputText value="#{val.estado}" style="text-transform:uppercase; font-size: 9px;"/>
                        </p:column>
                        <p:column headerText="Aprob.Por" style="font-size: 9px">
                            <h:outputText value="#{val.aprobadopor}" style="text-transform:uppercase; font-size: 9px;"/>
                        </p:column>
                        <p:column headerText="Fecha Not." style="font-size: 9px">
                            <h:outputText value="#{val.tiaFechaFin}" style="text-transform:uppercase; font-size: 9px;"/>
                        </p:column>
                        <p:column headerText="Declaración"  style="font-size: 9px">
                            <div style="text-align: center;">
                                <p:commandButton 
                                                 actionListener="#{bk_NotificarInversion.verDeclaracion}"
                                                 image="ui-icon-pencil" oncomplete="declaracion_inv.show();" update=":sdeclaracion_inv" >
                                    <f:attribute id="valorizacionDec" name="valorizacionDec" value="#{val}"/>
                                </p:commandButton>
                            </div>
                        </p:column>
                        <p:column headerText="Notificar"  rendered="#{bk_NotificarInversion.rolOpcion.troAgregar eq 1}" style="font-size: 9px">
                            <div style="text-align: center;">
                                <p:commandButton rendered="#{val.iaeId eq 4}"
                                                 actionListener="#{bk_NotificarInversion.notificarDeclaracion}"
                                                 image="ui-icon-pencil" oncomplete="notificar_inv.show();">
                                    <f:attribute id="valorizacion" name="valorizacion" value="#{val}"/>
                                </p:commandButton>
                            </div>
                        </p:column>
                        <p:column headerText="Cargo" style="font-size: 9px" >
                            <div style="text-align: center;">
                            
                            <p:commandButton  icon="ui-icon-arrowthick-1-s" ajax="false" rendered="#{val.tiaRutaNot ne null}"
                                                                     actionListener="#{bk_NotificarInversion.preDownloadNotificacion(val.tiaRutaNot)}">
                                                        <p:fileDownload value="#{bk_NotificarInversion.downloadNotificacion}"></p:fileDownload>
                                                    </p:commandButton>
                            
                                                          
                            </div>
                        </p:column>
                    </p:dataTable>
                </div>
                </div>
                 </h:form>
                </p:layoutUnit>
                </p:layout>
                
                
           
            <p:dialog widgetVar="notificar_inv" id="snotificar_inv" header="NOTIFICAR INVERSIÓN" height="450"
                          width="760" appendToBody="true" modal="true">
                          <h:form id="frmDialog" enctype="multipart/form-data" >
                    <p:growl id="mensaje2" showDetail="true" life="3000"/>
                    <div align="center" style="width: 100%" >
                        <table style="margin-bottom:5px;font-size: 11px; height: 420px;" >
                            <tr>
                                <td>
                                    <p:fieldset styleClass="fielsetinterno" legend="#{leg.dsdt}"
                                                style="margin-bottom:5px;font-size: 11px;">
                                        <table style="width:100% ;font-size:11px;">
                                            <tr>
                                                <td align="left">
                                                    #{cam.numhr}
                                                     
                                                    <p:inputMask style="width:100px" id="nrohrnot"
                                                                 value="#{bk_NotificarInversion.nrohrnot}" maxlength="4"
                                                                 mask="9?999"/>
                                                     
                                                    <p:watermark for="nrohrnot" value="#{cam.inum}"/>
                                                     
                                                    <p:inputMask style="width:100px" id="añohrnot"
                                                                 value="#{bk_NotificarInversion.añohrnot}" maxlength="4"
                                                                 mask="9999"/>
                                                     
                                                    <p:watermark for="añohrnot" value="#{cam.iaño}"/>
                                                     
                                                    <p:commandButton image="ui-icon-search"
                                                                     actionListener="#{bk_NotificarInversion.BuscarStd}"
                                                                     update=":frmDialog:freghrnot :frmDialog:asuntohrnot :frmDialog:mensaje2"/>
                                                </td>
                                                <td align="left">
                                                    #{cam.FR}<p:inputText id="freghrnot" readonly="true"
                                                                          value="#{bk_NotificarInversion.freghrnot}"/>
                                                </td>
                                            </tr>
                                             
                                            <tr>
                                                <td colspan="2" align="left">
                                                    #{cam.asu}
                                                     
                                                    <p:inputTextarea style="width:80%" id="asuntohrnot"
                                                                     value="#{bk_NotificarInversion.asuntohrnot}"/>
                                                </td>
                                            </tr>
                                        </table>
                                    </p:fieldset>
                                </td>
                            </tr>
                             
                            <tr>
                                <td>
                                    <p:fieldset styleClass="fielsetinterno" legend="#{leg.dcargo}"
                                                style="margin-bottom:5px;font-size: 11px;">
                                        <table style="width:100% ;font-size:11px;">
                                            <tr>
                                                <td align="left">
                                                    #{cam.numCargo}
                                                     
                                                    <p:inputMask style="width:100px" id="nrocargo"
                                                                 value="#{bk_NotificarInversion.nrocargo}" maxlength="4"
                                                                 mask="9?999"/>
                                                     
                                                    <p:watermark for="nrocargo" value="#{cam.numCargo}"/>
                                                </td>
                                                <td align="left">
                                                    #{cam.apor}
                                                     
                                                    <p:selectOneMenu id="aprobadopor"
                                                                     value="#{bk_NotificarInversion.aprobadopor}">
                                                        <f:selectItem itemLabel="-Seleccionar-" itemValue="0"/>
                                                        <f:selectItems value="#{bk_NotificarInversion.listaAprobaciones}"
                                                                       var="listaaprob"
                                                                       itemLabel="#{listaaprob.itrDescripcion}"
                                                                       itemValue="#{listaaprob.itrId}"/>
                                                    </p:selectOneMenu>
                                                </td>
                                            </tr>
                                             
                                            <tr>
                                                <td align="left">
                                                    #{cam.FNot}<p:calendar locale="es" pattern="dd/MM/yyyy"
                                                                           id="fnotificacion"
                                                                           value="#{bk_NotificarInversion.fnotificacion}"/>
                                                </td>
                                                <td align="left">
                                                    #{cam.apdf}
                                                     
                                                   
                                                                 
                                                <p:inputText id="rutapdftext"
                                                             value="#{bk_NotificarInversion.rutapdf}"
                                                             style="width:200px;"
                                                            />
                                                <p:fileUpload fileUploadListener="#{bk_NotificarInversion.subirArchivo}"
                                                      update="rutapdftext" label="Adjuntar Archivo" auto="true" />
															
                                                </td>
                                            </tr>
                                           
                                        </table>
                                    </p:fieldset>
                                    
                                    
                                </td>
                            </tr>
                            
                             
                             <tr>
                             <td  >
                             <div style="text-align: center;">
                             <table style="width:100%;" >
                                     <tr>
                               
                                    <td >
                                        <p:commandButton rendered="#{bk_NotificarInversion.rolOpcion.troAgregar eq 1}" value="#{btn.btn_guardar}" actionListener="#{bk_NotificarInversion.GrabarNotificacion}" update=":frmDialog:mensaje2 :form:tablaValorizaciones" />
                                        <p:commandButton value="#{btn.btn_salir}" onclick="notificar_inv.hide()"/>                               
                               
                                </td>
                                </tr>
                                    </table>
                                     </div>
                                    </td>
                                    </tr>
                            
                        </table>
                    </div>
                    </h:form>
                </p:dialog>               
                
                 <p:dialog widgetVar="declaracion_inv" id="sdeclaracion_inv" header="INVERSIÓN DECLARADA" height="560"
                          width="1300" >
                         
              <div align="center" style="width: 100%" >
                    
                    <table style="font-size: 11px">
                                <tr>
                                    <td valign="top">
                 <p:fieldset styleClass="fielsetinterno" id="datosConcesion"
                                                        legend="Datos Concesión">
                                                <table>
                                                    <tr>
                                                        <td align="left">Concesión</td>
                                                        <td>
                                                            <p:inputText value="#{bk_NotificarInversion.nombreConcesion}"
                                                                         readonly="true" style="width:260px"></p:inputText>
                                                        </td>
                                                    </tr>
                                                     
                                                    <tr>
                                                        <td align="left">Tipo Infraestructura</td>
                                                        <td>
                                                            <p:inputText value="#{bk_NotificarInversion.nombreTipoInfraestructura}"
                                                                         readonly="true" style="width:260px"></p:inputText>
                                                        </td>
                                                    </tr>
                                                     
                                                    <tr>
                                                        <td align="left">Modalidad Concesión</td>
                                                        <td>
                                                            <p:inputText value="#{bk_NotificarInversion.nombreModalidad}"
                                                                         style="width:260px" readonly="true"></p:inputText>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </p:fieldset>
                                            
                                            
                                             <p:fieldset styleClass="fielsetinterno" id="datosCompromiso"
                                                        legend="ETAPA DE CONSECIÓN">
                                                <table>
                                                    <tr>
                                                        <td colspan="1" align="left">
                                                            #{cam.setapa}
                                                        </td>
                                                        <td colspan="3" align="left">
                                                        <p:inputText value="#{bk_NotificarInversion.nombreEtapa}"
                                                                         style="width: 260px"
                                                                         readonly="true" />                                                      
                                                                                                                
                                                        </td>
                                                    </tr>
                                                     
                                                    <tr>
                                                        <td align="left">Plazo:</td>
                                                        <td align="left" colspan="3">
                                                            <p:inputText value="#{bk_NotificarInversion.desPlazo}"
                                                                         style="width: 260px"
                                                                         readonly="true" />
                                                             
                                                        </td>
                                                    </tr>
                                                     
                                                    <tr>
                                                        <td align="left">Total:</td>
                                                        <td align="left">
                                                            <p:inputText value="#{bk_NotificarInversion.etapaTotal}"
                                                                         style="text-align:right; " readonly="true"
                                                                         ></p:inputText>
                                                        </td>
                                                        <td align="left">
                                                            #{cam.mon}
                                                        </td>
                                                        <td align="left">
                                                            <p:inputText value="#{bk_NotificarInversion.monNombre}"
                                                                         readonly="true" ></p:inputText>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </p:fieldset>
                                            
                                             <table>
                                                <tr>
                                                    <td>Estado del Reconomiento:</td>
                                                    <td>
                                                    <p:inputText value="#{bk_NotificarInversion.estadoReconocimiento}"
                                                                         readonly="true" style="width:260px;"></p:inputText>
                                                        
                                                    </td>
                                                </tr>
                                                 
                                                <tr>
                                                    <td>Observación</td>
                                                    <td>
                                                        <p:inputTextarea id="obsRecf" style="width:400px;"    
                                                        value="#{bk_NotificarInversion.invAvnVO.tiaObservaciones}"
                                                                          readonly="true"/>
                                                    </td>
                                                    
                                                </tr>
                                            </table>
                                            
                                            </td>
                                            
                                            <td valign="top">
                                             <p:fieldset legend="Resultado del Reconocimiento" >
                                                                    <table>
                                                                        <tr>
                                                                            <td colspan="3">
                                                                                <p:dataTable value="#{bk_NotificarInversion.listaReconocimiento}" 
                                                                                             id="tblResultadoReconocimiento"
                                                                                             var="reconocimiento"
                                                                                             style="font-size:11px;"
                                                                                             emptyMessage="No se Encontraron Registros"
                                                                                             rowIndexVar="rowIndex" >
                                                                                    <p:column headerText="Nro. Valorización"
                                                                                              style="width:7%">
                                                                                        <div style="text-align: center;">
                                                                                            <h:outputText value="#{reconocimiento.ireId}"/>
                                                                                        </div>
                                                                                    </p:column>
                                                                                    
                                                                                    <p:column headerText="Descripcion del Concepto"
                                                                                              style="width:10%">
                                                                                        <h:outputText value="#{reconocimiento.desConcepto}"/>
                                                                                    </p:column>
                                                                                    <p:column headerText="Moneda"
                                                                                              style="width:35%">
                                                                                        <h:outputText value="#{reconocimiento.nombreMoneda}"/>
                                                                                    </p:column>
                                                                                    <p:column headerText="MontoPresentado"
                                                                                              style="width:35%;">
                                                                                        <h:outputText value="#{reconocimiento.ivrMontoPresentado}"
                                                                                                      style="text-transform:uppercase;"/>
                                                                                    </p:column>
                                                                                    <p:column headerText="MontoAprobado"
                                                                                              style="width:35%;">
                                                                                        <h:outputText value="#{reconocimiento.ivrMontoAprobado}"
                                                                                                      style="text-transform:uppercase;"/>
                                                                                    </p:column>
                                                                                    
                                                                                    <p:columnGroup type="footer">
                                                                                        <p:row>
                                                                                            <p:column colspan="3"
                                                                                                      footerText="Total"
                                                                                                      style="text-align:right;"></p:column>
                                                                                            <p:column footerText="#{bk_NotificarInversion.totalivrMontoPresentado}"
                                                                                                      style="text-align:left;"></p:column>
                                                                                            <p:column footerText="#{bk_NotificarInversion.totalivrMontoAprobado}"
                                                                                                      style="text-align:left;"></p:column>
                                                                                            
                                                                                        </p:row>
                                                                                    </p:columnGroup>
                                                                                </p:dataTable>
                                                                            </td>
                                                                        </tr>
                                                                    </table>
                                                                </p:fieldset>
                                                                
                                                                <br></br>
                                                                <br></br>
                                                                
                                                                <p:fieldset legend="Reajuste">
                                                                    <table>
                                                                        <tr>
                                                                            <td colspan="3">
                                                                                <p:dataTable value="#{bk_NotificarInversion.listaReajuste}"
                                                                                             id="tblReajuste"
                                                                                             var="reajuste"
                                                                                             style="font-size:11px"
                                                                                             emptyMessage="No se Encontraron Registros">
                                                                                    <p:column headerText="Nro. Valorización"
                                                                                              style="width:7%">
                                                                                        <div style="text-align: center;">
                                                                                            <h:outputText value="#{reajuste.irjId}"/>
                                                                                        </div>
                                                                                    </p:column>
                                                                                   
                                                                                    <p:column headerText="Descripcion del Concepto"
                                                                                              style="width:10%">
                                                                                        <h:outputText value="#{reajuste.desConcepto}"/>
                                                                                    </p:column>
                                                                                    <p:column headerText="Moneda"
                                                                                              style="width:35%">
                                                                                        <h:outputText value="#{reajuste.nombreMoneda}"/>
                                                                                    </p:column>
                                                                                    <p:column headerText="MontoAprobado"
                                                                                              style="width:35%">
                                                                                        <h:outputText value="#{reajuste.irjMontoAprobado}"
                                                                                                      style="text-transform:uppercase;"/>
                                                                                    </p:column>
                                                                                    <p:column headerText="MontoReajuste"
                                                                                              style="width:35%">
                                                                                        <h:outputText value="#{reajuste.irjMontoReajuste}"
                                                                                                      style="text-transform:uppercase;"/>
                                                                                    </p:column>
                                                                                    
                                                                                    <p:columnGroup type="footer">
                                                                                        <p:row>
                                                                                            <p:column colspan="3"
                                                                                                      footerText="Total"
                                                                                                      style="text-align:right;"></p:column>
                                                                                            <p:column footerText="#{bk_NotificarInversion.totalirjMontoAprobado}"
                                                                                                      style="text-align:left;"></p:column>
                                                                                            <p:column footerText="#{bk_NotificarInversion.totalirjMontoReajuste}"
                                                                                                      style="text-align:left;"></p:column>
                                                                                            
                                                                                        </p:row>
                                                                                    </p:columnGroup>
                                                                                </p:dataTable>
                                                                            </td>
                                                                        </tr>
                                                                    </table>
                                                                </p:fieldset>
                                                                
                                                                
                                                                 <p:fieldset legend="RESUMEN">
                                                                    <table style="width:100%;">
                                                                        <tr>
                                                                            <td>Monto Total Aprobado</td>
                                                                            <td>
                                                                                <p:inputText id="resumenMonPre" value="#{bk_NotificarInversion.totalivrMontoAprobadoI}" readonly="true" />
                                                                            </td>
                                                                            <td>Monto Total con Reajuste</td>
                                                                            <td>
                                                                                <p:inputText id="resumenMonRea" value="#{bk_NotificarInversion.totalirjMontoReajusteI}" readonly="true" />
                                                                            </td>
                                                                            
                                                                            
                                                                        </tr>
                                                                    </table>
                                                                    <br></br>
                                                                    <table>
                                                        <tr>
                                                        <td><h:outputText value="Nro Informe" /></td>
                                                        <td><p:inputText value="#{bk_NotificarInversion.invVO.invNumeroInforme}" readonly="true"/></td>
                                                        
                                                        <td><h:outputText value="Fecha de Emision" /></td>                                                      
                                                        <td><p:inputText  value="#{bk_NotificarInversion.invVO.invFechaEmisionInforme}" readonly="true"/></td>
                                                        
                                                        <td><h:outputText value="Registro de Salida" /></td>
                                                        <td><p:inputText value="#{bk_NotificarInversion.invVO.invRegSalidaInforme}" readonly="true"/></td>
                                                        </tr>
                                                        
                                                        <tr>
                                                        <td><h:outputText value="Nro Oficio" /></td>
                                                        <td><p:inputText value="#{bk_NotificarInversion.invVO.invNumeroOficio}" readonly="true"/></td>
                                                        
                                                        <td><h:outputText value="Fecha de Emision" /></td>                                                      
                                                        <td><p:inputText value="#{bk_NotificarInversion.invVO.invFechaEmisionOficio}" readonly="true"/></td>
                                                        
                                                        <td><h:outputText value="Registro de Salida" /></td>
                                                        <td><p:inputText value="#{bk_NotificarInversion.invVO.invRegSalidaOficio}" readonly="true"/></td>
                                                        </tr>                                                    
                                            
                                                        
                                                        <tr>
                                                       
                                                        
                                                        <td ><h:outputText value="Nota" /></td>                                                      
                                                        <td colspan="5"><p:inputTextarea style="width:100%;" value="#{bk_NotificarInversion.invVO.invNota}" readonly="true"/></td>                                                       
                                                       
                                                        </tr>
                                                        
                                                        
                                                        </table>
                                                                </p:fieldset>
                                                                
                                                                
                                            
                                            
                                            </td>
                                            </tr>
                                            </table>
                                            
                                            </div>
                  
                </p:dialog>
            
        </h:body>
    </html>
