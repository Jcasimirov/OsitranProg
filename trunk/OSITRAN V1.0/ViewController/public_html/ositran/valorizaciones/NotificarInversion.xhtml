<?xml version='1.0' encoding='windows-1252'?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:p="http://primefaces.org/ui">

        <h:head>
            <style type="text/css">
                .ui-dialog-titlebar {
                    font-size: 13px;
                    font-family: sans-serif;
                }
            </style>
            <link href="#{request.contextPath}/css/diseño.css" rel="stylesheet" type="text/css"/>
            <script type="text/javascript">
              PrimeFaces.locales['es'] = {
                  closeText : 'Cerrar', prevText : 'Anterior', nextText : 'Siguiente', monthNames : ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'], monthNamesShort : ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'], dayNames : ['Domingo', 'Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado'], dayNamesShort : ['Dom', 'Lun', 'Mar', 'Mie', 'Jue', 'Vie', 'Sab'], dayNamesMin : ['D', 'L', 'M', 'X', 'J', 'V', 'S'], weekHeader : 'Semana', firstDay : 1, isRTL : false, showMonthAfterYear : false, yearSuffix : '', timeOnlyTitle : 'Sólo hora', timeText : 'Tiempo', hourText : 'Hora', minuteText : 'Minuto', secondText : 'Segundo', currentText : 'Fecha actual', ampm : false, month : 'Mes', week : 'Semana', day : 'Día', allDayText : 'Todo el día'
              };
            </script>
        </h:head>
     <ui:include src="/ositran/util/menuOpciones.xhtml"/>
        <h:body>
        <f:event listener="#{bk_NotificarInversion.validarSesion}" type="preRenderComponent"></f:event>
            <f:event listener="#{bk_NotificarInversion.listarTipoAprobaciones}" type="preRenderComponent"/>             
            <f:event listener="#{bk_NotificarInversion.listarDeclaraciones}" type="preRenderComponent"/>                                  
          
            <p:growl id="mensaje" showDetail="true" life="3000"/>
            <p:layout style="min-width:400px;min-height:500px;">
                <p:layoutUnit position="center" minSize="300" visible="true" style="text-aling:center;">
                  <h:form  id="form" binding="#{bk_NotificarInversion.form}">
                    
                    <div align="center">
                        <h3 style="color:Black;font-weight:bold;font-family: sans-serif;">
                            NOTIFICAR INVERSIONES DECLARADAS
                        </h3>
                    </div>
                    <div align="center" style="font-size: 11px">
                <div style="width:100%" >
                    <p:dataTable value="#{bk_NotificarInversion.listaValorizaciones}" id="tablaValorizaciones" var="val"
                                 style="font-size:11px" rows="10" paginator="true"
                                 paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                 paginatorPosition="bottom" rowsPerPageTemplate="5,10,15"
                                 emptyMessage="No se Encontraron Registros" rowIndexVar="rowIndex">
                        <p:column headerText="N°" style="width:3%">
                            <h:outputText value=" #{rowIndex+1}" style="text-transform:uppercase;"/>
                        </p:column>
                        <p:column headerText="Tipo Infraestructura" style="width:7%">
                            <div style="text-align: center;">
                                <h:outputText value="#{val.nombreTipoInfraestructura}"
                                              style="text-transform:uppercase;"/>
                            </div>
                        </p:column>
                        <p:column headerText="Nro. Valorización" style="width:5%">
                            <h:outputText value="#{val.tiaNumero}"/>
                        </p:column>
                        <p:column headerText="Fecha Registro" style="width:10%">
                            <h:outputText value="#{val.tiaFechaRegistro}" style="text-transform:uppercase;"/>
                        </p:column>
                        <p:column headerText="Moneda" style="width:10%">
                            <h:outputText value="#{val.nombreMoneda}" style="text-transform:uppercase;"/>
                        </p:column>
                        <p:column headerText="Total Presentado" style="width:10%">
                            <h:outputText value="#{val.tiaMontoTotalPresentado}" style="text-transform:uppercase;"/>
                        </p:column>
                        <p:column headerText="Total Reconocido" style="width:10%">
                            <h:outputText value="#{val.tiaMontoTotalAprobado}" style="text-transform:uppercase;"/>
                        </p:column>
                        <p:column headerText="Total Reajustado" style="width:10%">
                            <h:outputText value="#{val.tiaMontoTotalReajustado}" style="text-transform:uppercase;"/>
                        </p:column>
                        <p:column headerText="Estado" style="width:10%">
                            <h:outputText value="#{val.estado}" style="text-transform:uppercase;"/>
                        </p:column>
                        <p:column headerText="AprobadoPor" style="width:10%">
                            <h:outputText value="#{val.aprobadopor}" style="text-transform:uppercase;"/>
                        </p:column>
                        <p:column headerText="Fecha Notificación" style="width:10%">
                            <h:outputText value="#{val.tiaFechaFin}" style="text-transform:uppercase;"/>
                        </p:column>
                        <p:column headerText="Notificar" style="width:5%" rendered="#{bk_NotificarInversion.rolOpcion.troAgregar eq 1}">
                            <div style="text-align: center;">
                                <p:commandButton rendered="#{val.iaeId eq 4}"
                                                 actionListener="#{bk_NotificarInversion.notificarDeclaracion}"
                                                 image="ui-icon-pencil" oncomplete="notificar_inv.show();">
                                    <f:attribute id="valorizacion" name="valorizacion" value="#{val}"/>
                                </p:commandButton>
                            </div>
                        </p:column>
                        <p:column headerText="Cargo" style="width:5%">
                            <div style="text-align: center;">
                            
                            <p:commandButton  icon="ui-icon-arrowthick-1-s" ajax="false" rendered="#{val.tiaRutaNot ne null}"
                                                                     actionListener="#{bk_NotificarInversion.preDownloadNotificacion(val.tiaRutaNot)}">
                                                        <p:fileDownload value="#{bk_NotificarInversion.downloadNotificacion}"></p:fileDownload>
                                                    </p:commandButton>
                            
                                                          
                            </div>
                        </p:column>
                    </p:dataTable>
                </div>
                </div>
                 </h:form>
                </p:layoutUnit>
                </p:layout>
                
                
           
            <p:dialog widgetVar="notificar_inv" id="snotificar_inv" header="NOTIFICAR INVERSIÓN" height="450"
                          width="760" appendToBody="true" modal="true">
                          <h:form id="frmDialog" enctype="multipart/form-data" >
                    <p:growl id="mensaje2" showDetail="true" life="3000"/>
                    <div align="center" style="width: 100%" >
                        <table style="margin-bottom:5px;font-size: 11px; height: 420px;" >
                            <tr>
                                <td>
                                    <p:fieldset styleClass="fielsetinterno" legend="#{leg.dsdt}"
                                                style="margin-bottom:5px;font-size: 11px;">
                                        <table style="width:100% ;font-size:11px;">
                                            <tr>
                                                <td align="left">
                                                    #{cam.numhr}
                                                     
                                                    <p:inputMask style="width:100px" id="nrohrnot"
                                                                 value="#{bk_NotificarInversion.nrohrnot}" maxlength="4"
                                                                 mask="9?999"/>
                                                     
                                                    <p:watermark for="nrohrnot" value="#{cam.inum}"/>
                                                     
                                                    <p:inputMask style="width:100px" id="añohrnot"
                                                                 value="#{bk_NotificarInversion.añohrnot}" maxlength="4"
                                                                 mask="9999"/>
                                                     
                                                    <p:watermark for="añohrnot" value="#{cam.iaño}"/>
                                                     
                                                    <p:commandButton image="ui-icon-search"
                                                                     actionListener="#{bk_NotificarInversion.BuscarStd}"
                                                                     update=":frmDialog:freghrnot :frmDialog:asuntohrnot :frmDialog:mensaje2"/>
                                                </td>
                                                <td align="left">
                                                    #{cam.FR}<p:inputText id="freghrnot" readonly="true"
                                                                          value="#{bk_NotificarInversion.freghrnot}"/>
                                                </td>
                                            </tr>
                                             
                                            <tr>
                                                <td colspan="2" align="left">
                                                    #{cam.asu}
                                                     
                                                    <p:inputTextarea style="width:80%" id="asuntohrnot"
                                                                     value="#{bk_NotificarInversion.asuntohrnot}"/>
                                                </td>
                                            </tr>
                                        </table>
                                    </p:fieldset>
                                </td>
                            </tr>
                             
                            <tr>
                                <td>
                                    <p:fieldset styleClass="fielsetinterno" legend="#{leg.dcargo}"
                                                style="margin-bottom:5px;font-size: 11px;">
                                        <table style="width:100% ;font-size:11px;">
                                            <tr>
                                                <td align="left">
                                                    #{cam.numCargo}
                                                     
                                                    <p:inputMask style="width:100px" id="nrocargo"
                                                                 value="#{bk_NotificarInversion.nrocargo}" maxlength="4"
                                                                 mask="9?999"/>
                                                     
                                                    <p:watermark for="nrocargo" value="#{cam.numCargo}"/>
                                                </td>
                                                <td align="left">
                                                    #{cam.apor}
                                                     
                                                    <p:selectOneMenu id="aprobadopor"
                                                                     value="#{bk_NotificarInversion.aprobadopor}">
                                                        <f:selectItem itemLabel="-Seleccionar-" itemValue="0"/>
                                                        <f:selectItems value="#{bk_NotificarInversion.listaAprobaciones}"
                                                                       var="listaaprob"
                                                                       itemLabel="#{listaaprob.itrDescripcion}"
                                                                       itemValue="#{listaaprob.itrId}"/>
                                                    </p:selectOneMenu>
                                                </td>
                                            </tr>
                                             
                                            <tr>
                                                <td align="left">
                                                    #{cam.FNot}<p:calendar locale="es" pattern="dd/MM/yyyy"
                                                                           id="fnotificacion"
                                                                           value="#{bk_NotificarInversion.fnotificacion}"/>
                                                </td>
                                                <td align="left">
                                                    #{cam.apdf}
                                                     
                                                   
                                                                 
                                                <p:inputText id="rutapdftext"
                                                             value="#{bk_NotificarInversion.rutapdf}"
                                                             style="width:200px;"
                                                            />
                                                <p:fileUpload fileUploadListener="#{bk_NotificarInversion.subirArchivo}"
                                                      update="rutapdftext" label="Adjuntar Archivo" auto="true" />
															
                                                </td>
                                            </tr>
                                           
                                        </table>
                                    </p:fieldset>
                                    
                                    
                                </td>
                            </tr>
                            
                             
                             <tr>
                             <td  >
                             <div style="text-align: center;">
                             <table style="width:100%;" >
                                     <tr>
                               
                                    <td >
                                        <p:commandButton rendered="#{bk_NotificarInversion.rolOpcion.troAgregar eq 1}" value="#{btn.btn_guardar}" actionListener="#{bk_NotificarInversion.GrabarNotificacion}" update=":frmDialog:mensaje2 :form:tablaValorizaciones" />
                                        <p:commandButton value="#{btn.btn_salir}" onclick="notificar_inv.hide()"/>                               
                               
                                </td>
                                </tr>
                                    </table>
                                     </div>
                                    </td>
                                    </tr>
                            
                        </table>
                    </div>
                    </h:form>
                </p:dialog>
            
        </h:body>
    </html>
