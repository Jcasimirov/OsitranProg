<?xml version='1.0' encoding='windows-1252'?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:p="http://primefaces.org/ui">
    <h:head>
        <link href="#{request.contextPath}/css/estilo.css" rel="stylesheet" type="text/css"/>
        <script type="text/javascript">
          PrimeFaces.locales['es'] = {
              closeText : 'Cerrar', prevText : 'Anterior', nextText : 'Siguiente', monthNames : ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'], monthNamesShort : ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'], dayNames : ['Domingo', 'Lunes', 'Martes', 'MiÃ©rcoles', 'Jueves', 'Viernes', 'SÃ¡bado'], dayNamesShort : ['Dom', 'Lun', 'Mar', 'Mie', 'Jue', 'Vie', 'Sab'], dayNamesMin : ['D', 'L', 'M', 'X', 'J', 'V', 'S'], weekHeader : 'Semana', firstDay : 1, isRTL : false, showMonthAfterYear : false, yearSuffix : '', timeOnlyTitle : 'SÃ³lo hora', timeText : 'Tiempo', hourText : 'Hora', minuteText : 'Minuto', secondText : 'Segundo', currentText : 'Fecha actual', ampm : false, month : 'Mes', week : 'Semana', day : 'DÃ­a', allDayText : 'Todo el dÃ­a'
          };
        </script>
        <style type="text/css">
            .ui-panel .ui-panel-titlebar {
                color: #333333;
                font-family: Arial;
            }
        </style>
    </h:head>
    <ui:include src="/ositran/util/menuOpciones.xhtml"/>
    <h:body>
        <f:event listener="#{asignarResponsableMB.validarSesion()}" type="postAddToView"></f:event>
        <f:event listener="#{asignarResponsableMB.cargarListaTiposInfraestructura()}" type="postAddToView"></f:event>
         
        <h:form id="form">
        <p:growl id="mensaje" showDetail="true"  life="3000" /> 
            
            <div align="center">
                <h3 style="color:Black;font-weight:bold;font-family: sans-serif;">
                    ASIGNAR RESPONSABLE DE SUPERVISION
                </h3>
            </div>
            <div align="center">
                <div align="center">
                    <table style="font-size:11px;width:90%">
                        <tr>
                            <td valign="top">
                                <p:fieldset legend="Datos contrato de Concesion">
                                    <table>
                                        <tr>
                                            <td>
                                                <p:fieldset legend="Conceción">
                                                    <p:inputText id="idNombreConcesion"
                                                                 value="#{asignarResponsableMB.nombreContratoConcesion}"
                                                                 style="width:300px;text-transform:uppercase;"></p:inputText>
                                                    <p:commandButton value="#{btn.btn_buscar}"
                                                                     oncomplete="Dialog_ResultadoBusquedaContratoConcesion.show()"
                                                                     actionListener="#{asignarResponsableMB.cargarListaContratos()}"
                                                                     update=":form:DataTable_ResultadoBusquedaContratosConcesion"/>
                                                </p:fieldset>
                                            </td>
                                        </tr>
                                         
                                        <tr>
                                            <td>
                                                <p:fieldset styleClass="fielsetinterno"
                                                            legend="Datos Contrato de Concesion">
                                                    <table>
                                                        <tr>
                                                            <td align="left">Nombre de concesión</td>
                                                            <td>
                                                                <p:inputText id="idNameConcesion"
                                                                             value="#{asignarResponsableMB.nameContrato}"
                                                                             style="width:300px;text-transform:uppercase;"></p:inputText>
                                                            </td>
                                                        </tr>
                                                         
                                                        <tr>
                                                            <td align="left">Tipo de infraestructura</td>
                                                            <td>
                                                                <p:inputText id="idNameTipoInfraestructura"
                                                                             value="#{asignarResponsableMB.nameTipoInfraestructura}"
                                                                             style="width:300px;text-transform:uppercase;"></p:inputText>
                                                            </td>
                                                        </tr>
                                                         
                                                        <tr>
                                                            <td align="left">Modalidad de Concesión</td>
                                                            <td>
                                                                <p:inputText id="idNameModalidadConcecion"
                                                                             value="#{asignarResponsableMB.nameModalidadConcesion}"
                                                                             style="width:300px;text-transform:uppercase;"></p:inputText>
                                                            </td>
                                                        </tr>
                                                         
                                                        
                                                         
                                                        
                                                         
                                                       
                                                    </table>
                                                </p:fieldset>
                                            </td>
                                        </tr>
                                         
                                        <tr>
                                            <td>
                                            <p:fieldset styleClass="fielsetinterno" id="datosCompromiso" legend="#{leg.etaCo}">
                                               
                                                    <table>
                                                        <tr>
                                                            <td  align="left">Etapa</td>
                                                            <td colspan="3" align="left">
                                                                <p:selectOneMenu id="listaCompromiso"  value="#{asignarResponsableMB.contratoCompromisoSeleccionado}" style="width:370px;text-transform:uppercase;">
                                                                    <f:selectItem   itemLabel="-Selecione-" itemValue="0" />
                                                                    <f:selectItems  value="#{asignarResponsableMB.listaContratoCompromiso}" var="tip2" itemLabel="#{tip2.ccoPeriodo}" itemValue="#{tip2.ccoId}"/>
                                                                    <p:ajax event="valueChange" update=":form:datosCompromiso :form:listaResponsables :form:cbosupervisor" listener="#{asignarResponsableMB.cargarDatosCompromiso()}"  />
                                                                </p:selectOneMenu>
                                                            </td>
                                                        </tr>
                                                        <tr>
          <td align="left">Plazo:</td>
          <td align="left" colspan="3"><p:inputText value="#{asignarResponsableMB.plazo}"  readonly="true"/></td>
         </tr>
 
         <tr>
          <td align="left">Total:</td>
          <td align="left" ><p:inputText value="#{asignarResponsableMB.total}" readonly="true"></p:inputText></td>
          <td align="left">#{cam.mon}</td>
          <td align="left"><p:inputText value="#{asignarResponsableMB.nombreMoneda}" readonly="true"></p:inputText></td>
         </tr>
         </table>
                                                         
                                                       
                                                </p:fieldset>
                                            </td>
                                        </tr>
                                    </table>
                                </p:fieldset>
                            </td>
                            <td>
                                <p:fieldset styleClass="fielsetinterno" legend="Criterios de Busqueda">
                                    <p:fieldset id="idBusquedaSupervisor" legend="Busqueda Coordinador Insitu">
                                        <table>
                                            <tr>
                                                
                                                <td>Supervision de Inversiones</td>
                                                <td>
                                                    <p:selectOneMenu id="cbosupervisor"
                                                                     value="#{asignarResponsableMB.codigoSupervisor}"
                                                                     style="width:150px;text-transform:uppercase;">
                                                       
                                                        <f:selectItem itemValue="0" itemLabel="-Seleccione-"/>
                                                        <f:selectItems value="#{asignarResponsableMB.listarSupervisoresxInfraestructura}"
                                                                       var="sup" itemLabel="#{sup.tsiNombre}"
                                                                       itemValue="#{sup.tsiId}"/>
                                                    </p:selectOneMenu></td>
                                                    <td>
                                                    <p:commandButton value="Asignar"
                                                                 actionListener="#{asignarResponsableMB.seleccionarSupervisor()}"
                                                                 update=":form:listaResponsables :form:mensaje"/>
                                                </td>
                                            </tr>
                                        </table>
                                    </p:fieldset>
                                    <br></br>
                                    <p:fieldset id="idBusquedaEmpSup" legend="Busqueda Empresa Supervisora">
                                    <table>
                                        <tr>
                                            <td>
                                            Nombre Empresa
                                                <p:inputText  id="idNombreEmpresaSupervisora"
                                                             value="#{asignarResponsableMB.nombreEmpresaSupervisora}"
                                                             style="width:200px;text-transform:uppercase;"></p:inputText>
                                                             </td><td>
                                          
                                                 
                                                <p:commandButton value="#{btn.btn_buscar}"
                                                                 actionListener="#{asignarResponsableMB.filtrarListaEmpSup()}"
                                                                 update=":form:DataTable_ResultadoBusquedaEmpresa :form:mensaje"
                                                                 />
                                                 
                                                <p:dialog header="EMPRESAS SUPERVISORAS"
                                                          widgetVar="Dialog_ResultadoBusquedaEmpresa"
                                                          id="Dialog_ResultadoBusquedaEmpresa" modal="true"
                                                          style="text-align:center;">
                                                    <p:dataTable style="font-size:11px;text-align:center"
                                                                 id="DataTable_ResultadoBusquedaEmpresa"
                                                                 value="#{asignarResponsableMB.listaEmpresasSup}"
                                                                 var="var1">
                                                        <p:column headerText="emps sup">
                                                            <h:outputText value="#{var1.supNombre}"
                                                                          style="width:300px;text-transform:uppercase;"/>
                                                        </p:column>
                                                        <p:column headerText="Elegir">
                                                            <p:commandButton actionListener="#{asignarResponsableMB.seleccionarEmpresa}"
                                                                             icon="ui-search"
                                                                             update=":form:listaResponsables :form:mensaje"
                                                                             oncomplete="Dialog_ResultadoBusquedaEmpresa.hide();">
                                                                <f:attribute name="empresa" value="#{var1}"></f:attribute>
                                                            </p:commandButton>
                                                        </p:column>
                                                    </p:dataTable>
                                                </p:dialog>
                                            </td>
                                        </tr>
                                    </table>
                                    </p:fieldset>
                                     </p:fieldset>
                                     <br></br>
                                     <p:fieldset id="idResultadoAsig" legend="Lista Responsables Asignados">
                                    <p:dataTable value="#{asignarResponsableMB.listaResponsables}" rowIndexVar="rowId"
                                                 var="list" id="listaResponsables">
                                        <p:column headerText="N° Documento">
                                            <h:outputText value="#{list.numeroDocumento}"
                                                          style="width:300px;text-transform:uppercase; "/>
                                        </p:column>
                                        <p:column headerText="Tipo Documento">
                                            <h:outputText value="#{list.tipoDocumento}"
                                                          style="width:300px;text-transform:uppercase; "/>
                                        </p:column>
                                        <p:column headerText="Nombre">
                                            <h:outputText value="#{list.nombre}"
                                                          style="width:300px;text-transform:uppercase; "/>
                                        </p:column>
                                        <p:column headerText="Fecha Asignación">
                                            <h:outputText value="#{list.fechaAsignacion}"
                                                          style="width:300px;text-transform:uppercase; "/>
                                        </p:column>
                                        <p:column headerText="Estado">
                                            <h:outputText value="#{list.estado}"
                                                          style="width:300px;text-transform:uppercase; "/>
                                        </p:column>
                                        <p:column headerText="Eliminar" rendered="#{asignarResponsableMB.rolOpcion.troEliminar eq 1}">
                                            <p:commandButton actionListener="#{asignarResponsableMB.eliminacionConfirmadaResponsable()}"
                                                             image="ui-icon-document" style="width:25px;height:25px"
                                                             update=":form:listaResponsables">
                                                <f:param name="rowId" id="rowId" value="#{rowId}"/>
                                                <f:param name="rowIdCod" id="rowIdCod" value="#{list.id}"/>
                                                
                                                
                                            </p:commandButton>
                                        </p:column>
                                        <p:column headerText="Desactivar" rendered="#{asignarResponsableMB.rolOpcion.troModificar eq 1}">
                                            <p:commandButton rendered="#{list.codEstado eq 1}" actionListener="#{asignarResponsableMB.desactivarConfirmadaResponsable()}"
                                                             image="ui-icon-document" style="width:25px;height:25px"
                                                             update=":form:listaResponsables">
                                                <f:param name="rowIdE" id="rowIdE" value="#{rowId}"/>
                                                <f:param name="rowIdCodDes" id="rowIdCodDes" value="#{list.id}"/>
                                                 
                                            </p:commandButton>
                                        </p:column>
                                    </p:dataTable>
                                </p:fieldset>
                               
                                <br></br>
                                 
                            
                                 
                                <br></br>
                            </td>
                        </tr>
                    </table>
                </div>
              
                <table style="width:80% ;font-size:11px;">
                    <tr>
                        <td align="center">
                            <p:commandButton rendered="#{asignarResponsableMB.rolOpcion.troAgregar eq 1}" value="Guardar" actionListener="#{asignarResponsableMB.Guardar()}"  update=":form:datosCompromiso :form:listaResponsables :form:mensaje "/>                                               
                            
                        </td>
                    </tr>
                </table>
                <p:dialog header="CONCESIONES" widgetVar="Dialog_ResultadoBusquedaContratoConcesion"
                          id="Dialog_ResultadoBusquedaContratoConcesion" modal="true" style="text-align:center;">
                    <p:dataTable style="font-size:11px;text-align:center"
                                 id="DataTable_ResultadoBusquedaContratosConcesion" var="var2"
                                 value="#{asignarResponsableMB.listaContratosConcesion}">
                        <p:column headerText="Nombre de la Concesión">
                            <h:outputText value="#{var2.nombreConcesion}"
                                          style="width:300px;text-transform:uppercase;"/>
                        </p:column>
                        <p:column headerText="Nombre del Tipo Infraestructura">
                            <h:outputText value="#{var2.nombreTipoInfraestructura}"
                                          style="width:300px;text-transform:uppercase;"/>
                        </p:column>
                        <p:column headerText="Nombre de la Modalidad">
                            <h:outputText value="#{var2.nombreModalidad}"
                                          style="width:300px;text-transform:uppercase;"/>
                        </p:column>
                        <p:column headerText="Elegir">
                            <p:commandButton actionListener="#{asignarResponsableMB.seleccionarContratoConcesion1}"
                                             icon="ui-search"
                                             update=":form:idNameConcesion :form:idNameTipoInfraestructura :form:idNameModalidadConcecion  :form:listaCompromiso"
                                             oncomplete="Dialog_ResultadoBusquedaContratoConcesion.hide();">
                                <f:attribute name="contrato" value="#{var2}"></f:attribute>
                            </p:commandButton>
                        </p:column>
                    </p:dataTable>
                </p:dialog>
            </div>
        </h:form>
    </h:body>
</html>